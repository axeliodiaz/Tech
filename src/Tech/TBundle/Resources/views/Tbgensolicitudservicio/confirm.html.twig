{% extends '::layout.html.twig' %}

{% block content %}
<script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
{% for flashMessage in app.session.flashbag.get('flash_info') %}
<div class="isa_info">
        {{ flashMessage }}
    </div>

{% endfor %}
 

{% for flashMessage in app.session.flashbag.get('flash_warning') %}
<div class="isa_warning">
        {{ flashMessage }}
    </div>

{% endfor %}
 


{% for flashMessage in app.session.flashbag.get('flash_error') %}
<div class="isa_error">
        {{ flashMessage }}
    </div>

{% endfor %}
 


{% for flashMessage in app.session.flashbag.get('flash_success') %}
<div class="isa_success">
        {{ flashMessage }}
    </div>

{% endfor %}
 
<h1>Solicitud de Servicio</h1>

<div class="container" >

    <section class="register">
        <br>
        <h1>Ingrese los siguientes datos:</h1>
        <br>
        <form action="{{ path('SolicitudServicio_create') }}" method="post" class="login">
              {{ form_start(form) }}
        {{ form_errors(form) }}  
            <table width="800">
                <tr>
                        
             <td id="campos5">
                 
                 <div class="error">
                {{ form_errors(form.tbgentiposolicitud) }}</div>       
                    <table>  <td><h2>1. </h2></td><td width="115">
                {{ form_label(form.tbgentiposolicitud, 'Tipo Solicitud:') }}</td>
                        <td>{{ form_widget(form.tbgentiposolicitud,{'required': true}) }}</td>
                    
                 <td width="5"></td>
                <div class="error" >
                {{ form_errors(form.fkIidEspSol) }}</div>       
                 <td><h2>2. </h2></td><td width="100">
                {{ form_label(form.fkIidEspSol, 'Especificación:') }}</td>
                        <td>{{ form_widget(form.fkIidEspSol,{'required': true}) }}</td>
                 
                 <td width="5"></td>
                <div class="error" >
                {{ form_errors(form.vdetalles) }}</div>       
                      <td><h2>3. </h2></td><td width="80">
                {{ form_label(form.vdetalles, 'Detalles:') }}</td>
                    <td>{{ form_widget(form.vdetalles,{'required': false}) }}</td>
                    </table>
                 
                 </td>
             </tr>
             <tr>
                         
             <td id="campos1">
                 <div class="error">
                {{ form_errors(form.vdescripcion) }}</div>       
                    <table>  
                    <td width="100">
                    {{ form_label(form.vdescripcion, 'Descripción:') }}</td>
                        <tr></tr>
                    <td  width="150">{{ form_widget(form.vdescripcion,{'required': false}) }}</td>
                    
                    </table>
             </td>
              
                <table id="campos3">
                    <tr>
                        <td width="115"><h2>4.</h2>
                         <label> Datos Persona Contacto: </label> </td>
                        </tr>
                    <tr>
                        <td width="300">
                           
                    <table> 
                       <td width="115">
                {{ form_label(form.vpersona, 'Nombre:') }}</td>
                    <td>{{ form_widget(form.vpersona,{'required': false}) }}</td>
                    </table>
                            <div class="error" id="det">
                {{ form_errors(form.vpersona) }}</div>
                            </td>
                            <td width="10"></td>
                    <td>
                       
                    <table>  <td width="80">
                {{ form_label(form.vtelefono, 'Teléfono:') }}</td>
                    <td>{{ form_widget(form.vtelefono,{'required': false}) }}</td>
                    </table>
                        <div class="error" id="det">
                {{ form_errors(form.vtelefono) }}</div>
                   </td>
                    <td width="10"></td>
                   <td>
                         
                    <table>  <td width="80">
                {{ form_label(form.vcorreo, 'Correo:') }}</td>
                    <td>{{ form_widget(form.vcorreo,{'required': false}) }}</td>
                    </table>
                       <div class="error" id="det">
                {{ form_errors(form.vcorreo) }}</div>  
                    </td>
                    </tr>                      
                    </table>
                    <table id="campos2">
                    <tr>
                    
                    <td width="10">
                    {{ form_label(form.vdireccion, 'Dirección:') }}
                    {{ form_widget(form.vdireccion,{'required': false}) }}
                    <div class="error" id="det">
                    {{ form_errors(form.vdireccion) }}</div>       
                    </td>
                    
                    </tr>
                    
                    </table>
                     <h1><br></h1><br>
                     <div style="display: none;">     
                {{ form_row(form.fkIidEstatus, {'required' : false})}}
                {{ form_row(form.dfechaCreacion, {'required' : false})}}
                {{ form_row(form.fkIidUsuaDatos, {'required' : false})}}
                {{ form_row(form.iid, {'required' : false})}}                      
                {{ form_row(form.submit, { 'label': 'Registrar' }) }}        
                </div>  
                
                    </tr>
                   
                {{ form_end(form) }} 
                
            </table>
            
        </form>  
                
                <a href="{{ path('SolicitudServicio_new') }}">
               << Volver
            </a>   
    </section>
</div>
{% block javascripts %}
    {{ parent() }}

 <script>
     $('#campos1').hide();
     $('#campos2').hide();
     $('#campos3').hide();
     $('#campos4').hide();  
      
     var $name = $('#tech_tbundle_tbgensolicitudservicio_fkIidEspSol').find(":selected").text();
     if ($name!=='Seleccionar'){
                        $('#campos1').hide();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide(); 
      if(($name==='Cambio de modelo de camaras' || $name==='Camaras adicionales')){
                        $('#campos1').hide();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').show();     
                        
                  }else{
                      if (($name==='Notas de Credito' || $name==='Motivo A' || $name==='Motivo B')){
                        $('#campos1').show();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide();     
                        
                  }else{
                        if ($name==='Nueva Localidad'){
                        $('#campos1').hide();
                        $('#campos3').show();
                        $('#campos2').show();     
                        $('#campos4').hide();    
                      
                          //  alert('noes');
                        }else{
                        $('#campos1').hide();
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide();         
                        }
                    }
     }
 }
//$('#campos4').hide();
            $(function() {
                $(document).on('change', '.tbgentiposolicitud_selector', function() {
//                    alert("Han cambiado mi valor");
                        $('#campos1').hide();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide();     
                        
                    var data = {
                        tbgentiposolicitud_id: $(this).val()
                    };

                    $.ajax({
                        type: 'post',
                        url: '{{ path("especs") }}',
                        data: data,
                        dataType: 'json',
                        success: function(data) {
                            if (data.error !== undefined && data.error !== '') {
                                alert(data.error);
                            } else {
                                var $tbgenespecsolicitud_selector = $('#tech_tbundle_tbgensolicitudservicio_fkIidEspSol');
                                    $tbgenespecsolicitud_selector.html('<option>Seleccionar</option>');  
                                if (data.length!== undefined ){
                                    for (var i=0, total = data.length; i < total; i++) {
                                        $tbgenespecsolicitud_selector.append('<option value="' + data[i].id + '">' + data[i].name + '</option>');
                                    }
                                    $tbgenespecsolicitud_selector .prop('disabled',false);  
                                    
                                }else{
                                    $tbgenespecsolicitud_selector .html('<option> No Seleccionar</option>');
                                    $tbgenespecsolicitud_selector .prop('disabled','disabled');  
                                    var $tbgendetalle_selector = $('#tech_tbundle_tbgensolicitudservicio_vdetalles');
                            $tbgendetalle_selector.html('<option> No Seleccionar</option>');
                            $tbgendetalle_selector.prop('disabled','disabled');  
                                }
                            }
                        },
                        error: function(e, ts, et) {
                            alert(ts);
                            
                        }
                    });


                });

            });
            $(function() {
                $(document).on('change', '.tbgenespecsolicitud_selector', function() {
//                    alert("Han cambiado mi valor");
                  var $name = $(this).find(":selected").text();
                  //alert($name);
                  if(($name==='Cambio de modelo de camaras' || $name==='Camaras adicionales')){
                        $('#campos1').hide();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').show();     
                        $('#tech_tbundle_tbgensolicitudservicio_vpersona').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vtelefono').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vcorreo').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vdireccion').prop('required',false);
                        $('#tech_tbundle_tbgensolicitudservicio_vdescripcion').prop('required',false);
                  }else{
                      if (($name==='Notas de Credito' || $name==='Motivo A' || $name==='Motivo B')){
                        $('#campos1').show();     
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide();     
                        $('#tech_tbundle_tbgensolicitudservicio_vdescripcion').prop('required',true);
                        $('#tech_tbundle_tbgensolicitudservicio_vpersona').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vtelefono').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vcorreo').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vdireccion').prop('required',false);
                        
                  }else{
                        if ($name==='Nueva Localidad'){
                        $('#campos1').hide();
                        $('#campos3').show();
                        $('#campos2').show();     
                        $('#campos4').hide();
                        $('#tech_tbundle_tbgensolicitudservicio_vpersona').prop('required',true);  
                        $('#tech_tbundle_tbgensolicitudservicio_vtelefono').prop('required',true);  
                        $('#tech_tbundle_tbgensolicitudservicio_vcorreo').prop('required',true);  
                        $('#tech_tbundle_tbgensolicitudservicio_vdireccion').prop('required',true);
                        $('#tech_tbundle_tbgensolicitudservicio_vdescripcion').prop('required',false);    
                    //  alert('noes');
                        }else{
                        $('#campos1').hide();
                        $('#campos2').hide();     
                        $('#campos3').hide();     
                        $('#campos4').hide(); 
                        $('#tech_tbundle_tbgensolicitudservicio_vpersona').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vtelefono').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vcorreo').prop('required',false);  
                        $('#tech_tbundle_tbgensolicitudservicio_vdireccion').prop('required',false);
                        $('#tech_tbundle_tbgensolicitudservicio_vdescripcion').prop('required',false);
                        }
                    }
                }
                    var data = {
                        tbgenespecsolicitud_id: $(this).val()
                        
                    };
                    //alert("Valor"+$(this).val());
                    $.ajax({
                        type: 'post',
                        url: '{{ path("detalls") }}',
                        data: data,
                        dataType: 'json',
                        success: function(data) {
                            if (data.error !== undefined && data.error !== '') {
                                alert(data.error);
                            } else {
                            var $tbgendetalle_selector = $('#tech_tbundle_tbgensolicitudservicio_vdetalles');
                            
                            $tbgendetalle_selector.html('<option>Seleccionar</option>');
                            $tbgendetalle_selector.prop('disabled',false);     
                            $tbgendetalle_selector.prop('required',true);  
                            
                            if (data.length!== undefined ){
                            for (var i=0, total = data.length; i < total; i++) {
                       
                                  $tbgendetalle_selector.append('<option value="' + data[i].id + '">' + data[i].name + '</option>');
                       
                                  }
                                  //$tbgendetalle_selector.prop('disabled',false).prop('required',true);  
                                  
     
                            
                                if ($('#tech_tbundle_tbgensolicitudservicio_vdetalles').children('option').length>1){
                            //        $('#tech_tbundle_tbgensolicitudservicio_vdetalles').prop('required',true); 
                                }    
                        }else{
                            $tbgendetalle_selector.html('<option> No Seleccionar</option>');
                            $tbgendetalle_selector.prop('disabled','disabled');     
                            $tbgendetalle_selector.prop('required',false);  
                            
                        }
                    }
                        },
                        error: function(e, ts, et) {
                            alert(ts);
                            
                        }
                    });


                });

            });
  


        </script>

{% endblock %}
{% endblock %}



